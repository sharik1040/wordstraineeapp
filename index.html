<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Words Trainee</title>
        <link rel="stylesheet" href="css/style.css">
        <script src="js/parts.js"></script>
        <script>
            window.onload = function(){
                var roundContainer = document.getElementById("roundContainer");
                var reloadBtn = document.getElementById("reloadButton");

                var dictionary = [];
                var i=0;

                function getDictionary(){
                    var xhr = new XMLHttpRequest();
                    xhr.open("GET", "data/dictionary.json", true);

                    xhr.onreadystatechange = function(){
                        if(xhr.readyState == 4 && xhr.status == 200){
                            dictionary = JSON.parse(xhr.responseText);
                        }
                    }
                    xhr.send();
                }

                function getNewRound(){
                    var xhr = new XMLHttpRequest(); 
                    xhr.open("GET", "component/round.html", true); 

                    xhr.onreadystatechange = function () {
                        if (xhr.readyState == 4) {
                            if (xhr.status == 200) {
                                document.getElementById("roundContainer").innerHTML = xhr.responseText;
                                var lettersContainer = document.getElementById("lettersContainer");
                                var shuffledBlock = document.getElementById("shuffledBlock");
                                var round = new Round(dictionary[i], lettersContainer, shuffledBlock);
                                round.init();
                
                                if(i===dictionary.length-1){
                                    i=0;
                                }else{
                                    i++;
                                }
                            }
                        }
                    }
                    xhr.send();  
                }

                reloadBtn.onclick = function(){
                    getNewRound();
                }

                getDictionary();
                getNewRound();

                var helpBtn = document.getElementById("helpBtn");
                var helpBlock = document.getElementById("helpBlock");

                helpBtn.addEventListener("mouseover", function(){
                    helpBtn.innerHTML = "";
                    helpBlock.classList.add("help__block--display");
                }, false);
                helpBlock.addEventListener("mouseout", function(){
                    helpBtn.innerHTML = "?";
                    helpBlock.classList.remove("help__block--display");
                })

            };
        </script>
    </head>
    <body>
        <div class="header">
            <div class="help">
                <div class="help__btn" id="helpBtn">?</div>
                <div class="help__block" id="helpBlock">
                    Words Game App:<br><br>
                    <ul>
                        <li>Press "NEXT" to get new word.</li>
                        <li>Move letter from bottom list to upper list. OR 
                            Click on letter from bottom list and click on letter from upper list.
                        </li>
                        <li>If your choise is correct, then the letter border from upper list will be green.
                        </li>
                    </ul>
                </div>
            </div>
            <div id="reloadButton" class="reload-btn">next</div>
        </div>

        <div id="roundContainer"></div>
    </body>
</html>